<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>WIP</title>
    <link href="../../stylesheets/site.css" rel="stylesheet" data-turbolinks-track="reload" />
    <link href="../../stylesheets/syntax.css" rel="stylesheet" data-turbolinks-track="reload" />
    <script src="../../main.js" data-turbolinks-track="reload"></script>
  </head>
  <body class="page">
    <details id="table-of-contents" class="page__history" open>
      <summary class="page__history-summary">Table of Contents</summary>
      <nav class="history">

          <a href="../5d59b45ece450d98e2c4149b9db57bc1e4a9041f/">Ensure `tmp&#x2F;` and `source&#x2F;` directories exist
</a>
          <a href="../42a35c8343ae3ed962c3b21f62e1ec917ce34eec/">Introduce `Makefile`
</a>
          <a href="../87314ace144e16df7dba371f5106ec669f41aa17/">Created `README.md`
</a>
          <a href="../11f450c4b9b84d5d248dfcea206e34a4d8fb78c2/">Create the `.gitignore` file
</a>
          <a href="../43e0f6109cf2640ca94f90adf30a49de0b4c45d9/">template things out</a>
          <a href="../1966ee21ea7ad0dafeea2e930090fa3833c8514e/">generate more data</a>
          <a href="../c96f22474b8ae1153843de9c5262479a4c362626/">make available in other git directory</a>
          <a href="../dd647ec9cf6dc7c70a05b3896a464fda75113999/">current README, fix data file</a>
          <a href="../af567ecfe89778417d201afdb21d066ab21005d3/">move partial to top level template</a>
          <a href="../32a94acaae522a307bb2e83c3e4d197812b36609/">include CSS from Syntax highlighting</a>
          <a href="../aa6a082747a63d8daa51b3cffbfb15890e5b5e3a/">Install `bitters` for base styles
</a>
          <a href="../e9eda25546b8a590fac97a6de1ec9823a42fc888/">start to style page</a>
          <a href="../f83e06a9192e77bfaf8c66d8c33384ee68282193/">Prepare to generate JavaScript with Make</a>
          <a href="../11ccf674d47028ee591149134ea1b8c2eb28024a/">build JavaScript assets with Make</a>
          <a href="../532b5734e3b10910123cf899bc097c8ece44b749/">install Turbolinks, bundle with webpack</a>
          <a href="../93187d4cfbd11eb151de1685a770ecf72365f35b/">streamline Makefile</a>
          <a href="../e52955299c3c900a20d8e153c9be17069dca7c5c/">start to style layout</a>
          <a href="../f9d59463eccada46f3089f226ec6b787f877b4a9/">introduce CommitHelpers
</a>
          <a href="../13df0b4af96c16f7e021eb7fbb25ea79ccea471c/">more styling</a>
          <a href="../2aaa7efa50385d8983c28272dcf4233d1c4e9957/">Introduce `bin&#x2F;git-read`
</a>
          <a href="../03b2b6a853548bc7321e6018ce08ee44e5a74fa0/">make history collapsible on mobile</a>
          <a href="../63110797e2ae4d436da0839e56b60ff3f04a47bd/">Restore default `ul` and `ol` within Markdown
</a>
          <a href="../8f80bdd482310d51c9493e1dc75ce6b94f33d3d0/">Add &quot;current&quot; styles to `&lt;a&gt;` elements
</a>
          <a href="../5e6606a521316b80384903080d5cfdfc4c688343/">fixup JS&#x2F;webpack, external pipelines</a>
          <a href="../34e7b71a490ed1618c670ed25ac1b9aa2039015d/">generate data, don&#x27;t generate templates</a>
          <a href="../23ea6e6eef66f47579380e27bcdea4617fb3b67a/">Improve installation and cross-platform capabilities</a>
          <a href="../04020914d6e90696220867eed07b4f361dab0127/">Make your life easier with `ruby-git`
</a>
          <a href="../ce8d2db85a79d0acea721fb9c572102e8252025f/">improve setup</a>
          <a href="../319fb52a8833df9f36c31f3508e1a0e1997568da/">workflow</a>
          <a href="../ac343c8b674197a76aa02cf4596ac7b335fca9b5/">parallelize, cache</a>
          <a href="../f2ca94be72c920820b0f6830c48e8a9b2dc13a04/">combine calls to make</a>
          <a href="../5b66b59687169a79cf5ff8e606763cdd1c4e8e52/">fetch SHAs</a>
          <a href="../e216028c90ac13e9bd00abb412def411cead51dc/">minimize output, try and get whole tree</a>
          <a href="../92dc79b152dbb924565d533bf653238e49c01eca/">move files around after building</a>
          <a href="../79d2aa7bf8632500ff72b7aa0dbd1105ee850a66/">include Gemfile.lock for caching</a>
          <a href="../a3261a4a1f7c03e6cdae192d781bac32c63b301b/">build without cache</a>
          <a href="../d45d05f7dda519945cfe8b1b6de1ef523b28e6cf/">publish with different Action</a>
          <a href="../f10c24c94183013b17a22c8d348682fffa658347/">import assets relatively</a>
          <a href="../1abe4d0b0560fd6561fbc015c061e4340f90ad2d/">add caching back</a>
          <a href="../b2c8bc4325f38c8605bd400cc0d6056b32dfbfcb/">bust Gemfile cache, use relative links</a>
          <a href="../37c8d237d1821ac5255b0dc493dd0b07b189311b/">integrate with sitemap</a>
          <a href="../4de4aed13cdd07ee8de9e421f31249023bc8f218/">make it relative</a>
          <a href="../e19722f077e0c9df4c232229ae69534b4b50cb2d/">properly call no limit on git log</a>
          <a href="../31826742a47eecc7666a32dfc81643b55e5bebb1/">bust cache</a>
          <a href="../d19b75814f4a66e2ec2bc1a49b4226e71352376b/">sync ruby versions</a>
          <a href="../8ceee65d0eeb9c029b56d0a502d32aa5cba58db2/">do not cache</a>
          <a href="../88630325e3adad1b4f6922d9c66270d0953a63c8/">add back caching, use sitemap branch of current</a>
          <a href="../a08ee4e2c6f42e34749e903815054950d9569ab5/">Add link to project root</a>
          <a href="../406938f2d1f25bb6c83353df84718db343421b84/">configure command to take git directory and output</a>
          <a href="../63d6e19355548a1c9ccb389cfcb3e326339ae1ad/">improve spacing</a>
          <a href="./" aria-current="page">WIP</a>
          <a href="../f9d2e835af4ec5454876b02a604f88f372f8c43b/">Render files when initial commit</a>
          <a href="../e775a2985b99a0b02bfa566943b351269271c1c1/">memoize</a>
          <a href="../90a9873b074ffca4def61bd176a33c099bdef501/">extend the `bin&#x2F;git-read` command to take flags:
</a>
          <a href="../0acb182e86da666baad5e41388bf1e55ebe01d68/">don&#x27;t peg to Ruby version</a>
          <a href="../e4f3451f10170b510e5f9cade1d8dc1185f61c85/">make executable account for being run from elsewhere</a>
          <a href="../9f9fb88e9c29dd1bc30cd92d48ebd797adc45c81/">don&#x27;t use realpath on OUTPUT_DIR, it doesn&#x27;t exist</a>
          <a href="../96966fce5ddfe2e9ed89b915fad7f0f10f014782/">only run on pushes to master</a>
          <a href="../cebc9db90d27697e3dbf5566548201e259a6e602/">don&#x27;t tie to specific bundler version</a>
          <a href="../8c0a95be2d3ea0e73b9b918e3bb445a9c22b7082/">make arguments flexible, resolve with realpath</a>
          <a href="../459485710e02f2b4c73e5897c17c2e261b81a179/">page title and make `--serve` work</a>
          <a href="../b53a0d941e26d69fd36cccfba1b5ffce74bc127a/">Use block-accepting `current_link_to`
</a>
          <a href="../3c87b016d0e66abd228d48c6f0de21a03a99613c/">don&#x27;t run when passed --help</a>
      </nav>
    </details>

    <main class="page__content">
      <header class="navigation">

<a href="../63d6e19355548a1c9ccb389cfcb3e326339ae1ad/">              &#8592; Previous
</a>
<a href="../f9d2e835af4ec5454876b02a604f88f372f8c43b/">              Next &#8594;
</a>      </header>

      <article class="commit">
        <h1>WIP</h1>



              <details open>
  <summary>config.rb</summary>
<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/config.rb b/config.rb
index 617bb77..5ff7cf5 100644
</span><span class="gd">--- a/config.rb
</span><span class="gi">+++ b/config.rb
</span><span class="p">@@ -50,7 +50,7 @@</span> repository.log(nil).reverse_each do |commit|
   proxy(
     "/commits/#{commit.sha}/index.html",
     "/commits/commit.html",
<span class="gd">-    locals: { repository: repository, commit: commit },
</span><span class="gi">+    locals: { commit: commit },
</span>     ignore: true,
   )
 end
<span class="p">@@ -58,7 +58,7 @@</span> end
 proxy(
   "index.html",
   "README.html",
<span class="gd">-  locals: { repository: repository, readme: repository.object("HEAD:README.md") },
</span><span class="gi">+  locals: { readme: repository.object("HEAD:README.md") },
</span>   ignore: true,
 )
 
<span class="p">@@ -71,6 +71,7 @@</span> proxy(
 #     'Helping'
 #   end
 # end
<span class="gi">+CommitHelpers.repository = repository
</span> helpers CommitHelpers
 
 # Build-specific configuration
</code></pre></div></details>

              <details open>
  <summary>lib/commit_helpers.rb</summary>
<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/lib/commit_helpers.rb b/lib/commit_helpers.rb
index d120834..93ca59e 100644
</span><span class="gd">--- a/lib/commit_helpers.rb
</span><span class="gi">+++ b/lib/commit_helpers.rb
</span><span class="p">@@ -1,5 +1,13 @@</span>
 module CommitHelpers
<span class="gi">+  mattr_accessor :repository
+
</span>   def commit_path(commit)
     "/commits/#{commit.sha}/index.html"
   end
<span class="gi">+
+  def adjacent_commits(commit)
+    log = [nil].chain(repository.log(nil).reverse_each).chain([nil])
+
+    log.each_cons(3).detect { |_, middle, _| commit.sha == middle.sha }
+  end
</span> end
</code></pre></div></details>

              <details open>
  <summary>source/commits/commit.html.md.erb</summary>
<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/source/commits/commit.html.md.erb b/source/commits/commit.html.md.erb
index 28763fa..d24d7e5 100644
</span><span class="gd">--- a/source/commits/commit.html.md.erb
</span><span class="gi">+++ b/source/commits/commit.html.md.erb
</span><span class="p">@@ -5,7 +5,13 @@</span>
 
 &lt;%= messages.join %&gt;
 
<span class="gd">-```diff
-&lt;%= commit.diff_parent.patch -%&gt;
</span><span class="gi">+&lt;% parent, _, _ = adjacent_commits(commit) %&gt;
+
+&lt;% (parent.present? ? parent.diff(commit) : commit.diff(commit)).each do |diff| %&gt;
+&lt;%= diff.path %&gt;
+---
</span> 
<span class="gi">+```diff
+&lt;%= diff.patch %&gt;
</span> ```
<span class="gi">+&lt;% end %&gt;
</span></code></pre></div></details>

              <details open>
  <summary>source/layouts/layout.erb</summary>
<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/source/layouts/layout.erb b/source/layouts/layout.erb
index 686876b..de75a51 100644
</span><span class="gd">--- a/source/layouts/layout.erb
</span><span class="gi">+++ b/source/layouts/layout.erb
</span><span class="p">@@ -26,15 +26,16 @@</span>
     &lt;main class="page__content"&gt;
       &lt;header class="navigation"&gt;
         &lt;% if defined?(commit) %&gt;
<span class="gd">-          &lt;% if commit.parent.present? %&gt;
-            &lt;% link_to commit_path(commit.parent) do %&gt;
</span><span class="gi">+          &lt;% parent, _, child = adjacent_commits(commit) %&gt;
+
+          &lt;% if parent.present? %&gt;
+            &lt;% link_to commit_path(parent) do %&gt;
</span>               &amp;#8592; Previous
             &lt;% end %&gt;
           &lt;% end %&gt;
 
<span class="gd">-          &lt;% next_commit = repository.log(nil).detect { |child| child.parent&amp;.sha == commit.sha } %&gt;
-          &lt;% if next_commit.present? %&gt;
-            &lt;% link_to commit_path(next_commit) do %&gt;
</span><span class="gi">+          &lt;% if child.present? %&gt;
+            &lt;% link_to commit_path(child) do %&gt;
</span>               Next &amp;#8594;
             &lt;% end %&gt;
           &lt;% end %&gt;
</code></pre></div></details>

      </article>
    </main>
  </body>
</html>
